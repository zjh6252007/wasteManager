# 数据导入功能使用指南

## 功能概述

本系统支持从其他软件导出的数据导入功能，包括：

1. **用户信息导入** - 从包含客户信息的CSV/Excel文件导入
2. **车辆信息导入** - 从包含车辆信息的CSV/Excel文件导入，并自动匹配用户

## 支持的文件格式

- CSV文件 (.csv)
- Excel文件 (.xlsx, .xls)

## 用户信息导入

### 文件格式要求

用户信息文件应包含以下列（列名不区分大小写）：

| 列名 | 说明 | 必填 |
|------|------|------|
| RefNo | 原始系统中的参考编号 | 是 |
| Name | 客户姓名 | 是 |
| Address1 | 地址第一行 | 是 |
| Address2 | 地址第二行 | 否 |
| City | 城市 | 是 |
| State | 州/省 | 是 |
| ZIP Code | 邮政编码 | 是 |
| Telephone | 电话号码 | 否 |

### 示例文件格式

```csv
RefNo,Name,Address1,Address2,City,State,ZIP Code,Telephone
105,jose lui,1803 destiny blvd,Kissimme,Orlando,FL,34741,
172,frantz tl,2801 woodbridge,1,Fruitland,FL,32808,
1001,Alan Cher,7968 Niagara Fall,Orlando,Apopka,FL,32825,4.08E+09
```

## 车辆信息导入

### 文件格式要求

车辆信息文件应包含以下列（列名不区分大小写）：

| 列名 | 说明 | 必填 |
|------|------|------|
| Ref. No. | 原始系统中的参考编号 | 是 |
| License | 车牌号 | 是 |
| IDriver | 驾驶员姓名（用于匹配用户） | 否 |
| N | 年份 | 否 |
| Color | 颜色 | 是 |
| Make | 制造商 | 是 |
| Model | 型号 | 否 |

### 示例文件格式

```csv
Ref. No.,License,IDriver,N,Color,Make,Model
61,1569,,,Red,BMW,
105,gdfy23,,,Black,Infiniti,
1001,659VVH,Alan Cher,2009,Blue,Acura,TSX
```

## 使用步骤

1. **准备数据文件**
   - 确保文件格式符合上述要求
   - 检查数据完整性

2. **导入用户信息**
   - 点击 "Import Data" 标签
   - 点击 "Select Customer File" 按钮
   - 选择包含用户信息的CSV或Excel文件
   - 系统会自动导入并显示结果

3. **导入车辆信息**
   - 在 "Import Data" 页面
   - 点击 "Select Vehicle File" 按钮
   - 选择包含车辆信息的CSV或Excel文件
   - 系统会自动匹配用户并导入车辆信息

## 自动匹配规则

### 用户匹配
- 系统会根据姓名和地址的完全匹配来避免重复导入
- 如果发现相同姓名和地址的用户，会跳过导入

### 车辆匹配
- 系统会根据车辆数据中的 `IDriver` 字段与已导入的用户姓名进行匹配
- 如果找到匹配的用户，车辆会自动关联到该用户
- 如果没有匹配的用户，车辆会作为独立记录保存

## 导入结果

导入完成后，系统会显示：
- 成功导入的用户/车辆数量
- 任何错误信息
- 详细的导入日志

## 注意事项

1. **数据备份**：导入前建议备份现有数据
2. **文件编码**：确保CSV文件使用UTF-8编码
3. **重复数据**：系统会自动跳过重复的车牌号和用户信息
4. **错误处理**：如果某些记录导入失败，系统会继续处理其他记录并显示错误信息

## 故障排除

### 常见问题

1. **文件格式错误**
   - 确保列名正确
   - 检查文件编码
   - 验证数据格式

2. **导入失败**
   - 检查文件路径
   - 确认文件权限
   - 查看错误日志

3. **匹配问题**
   - 确保用户信息已先导入
   - 检查姓名拼写是否一致
   - 验证IDriver字段格式

### 技术支持

如果遇到问题，请：
1. 检查控制台错误信息
2. 确认文件格式正确
3. 联系技术支持
