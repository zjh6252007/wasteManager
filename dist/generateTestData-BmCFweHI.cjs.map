{"version":3,"file":"generateTestData-BmCFweHI.cjs","sources":["../src/main/generateTestData.ts"],"sourcesContent":["import { getDb } from './db/connection';\r\n\r\n// 生成随机测试数据\r\nexport async function generateTestData() {\r\n  const db = getDb();\r\n  \r\n  // 获取激活ID\r\n  const activation = db.prepare(\"SELECT id FROM activations LIMIT 1\").get() as { id: number };\r\n  if (!activation) {\r\n    console.log('No activation found, skipping test data generation');\r\n    return;\r\n  }\r\n  \r\n  const activationId = activation.id;\r\n  \r\n  // 获取现有的客户和金属类型\r\n  const customers = db.prepare(\"SELECT id FROM customers WHERE activation_id = ?\").all(activationId) as { id: number }[];\r\n  const metalTypes = db.prepare(\"SELECT id, price_per_unit FROM metal_types WHERE activation_id = ?\").all(activationId) as { id: number; price_per_unit: number }[];\r\n  \r\n  if (customers.length === 0 || metalTypes.length === 0) {\r\n    console.log('No customers or metal types found, skipping test data generation');\r\n    return;\r\n  }\r\n  \r\n  // 生成100条随机称重记录\r\n  const insertStmt = db.prepare(`\r\n    INSERT INTO weighings (activation_id, customer_id, waste_type_id, weight, unit_price, total_amount, notes, weighing_time)\r\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?)\r\n  `);\r\n  \r\n  const startDate = new Date('2024-01-01');\r\n  const endDate = new Date();\r\n  \r\n  for (let i = 0; i < 100; i++) {\r\n    // 随机选择客户（30%概率为null）\r\n    const customerId = Math.random() < 0.3 ? null : customers[Math.floor(Math.random() * customers.length)].id;\r\n    \r\n    // 随机选择金属类型\r\n    const metalType = metalTypes[Math.floor(Math.random() * metalTypes.length)];\r\n    \r\n    // 随机重量（0.1到100磅）\r\n    const weight = Math.random() * 99.9 + 0.1;\r\n    \r\n    // 计算总金额\r\n    const totalAmount = weight * metalType.price_per_unit;\r\n    \r\n    // 随机备注\r\n    const notes = Math.random() < 0.3 ? null : `Test note ${i + 1}`;\r\n    \r\n    // 随机时间\r\n    const randomTime = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));\r\n    \r\n    insertStmt.run(\r\n      activationId,\r\n      customerId,\r\n      metalType.id,\r\n      weight,\r\n      metalType.price_per_unit,\r\n      totalAmount,\r\n      notes,\r\n      randomTime.toISOString()\r\n    );\r\n  }\r\n  \r\n  console.log('Generated 100 random weighing records');\r\n}\r\n\r\n// 如果直接运行此文件，则生成测试数据\r\nif (require.main === module) {\r\n  generateTestData().then(() => {\r\n    console.log('Test data generation completed');\r\n    process.exit(0);\r\n  }).catch(error => {\r\n    console.error('Error generating test data:', error);\r\n    process.exit(1);\r\n  });\r\n}\r\n"],"names":["generateTestData","db","getDb","activation","activationId","customers","metalTypes","insertStmt","startDate","endDate","i","customerId","metalType","weight","totalAmount","notes","randomTime","error"],"mappings":"wHAGA,eAAsBA,GAAmB,CACvC,MAAMC,EAAKC,EAAAA,MAAA,EAGLC,EAAaF,EAAG,QAAQ,oCAAoC,EAAE,IAAA,EACpE,GAAI,CAACE,EAAY,CACf,QAAQ,IAAI,oDAAoD,EAChE,MACF,CAEA,MAAMC,EAAeD,EAAW,GAG1BE,EAAYJ,EAAG,QAAQ,kDAAkD,EAAE,IAAIG,CAAY,EAC3FE,EAAaL,EAAG,QAAQ,oEAAoE,EAAE,IAAIG,CAAY,EAEpH,GAAIC,EAAU,SAAW,GAAKC,EAAW,SAAW,EAAG,CACrD,QAAQ,IAAI,kEAAkE,EAC9E,MACF,CAGA,MAAMC,EAAaN,EAAG,QAAQ;AAAA;AAAA;AAAA,GAG7B,EAEKO,EAAY,IAAI,KAAK,YAAY,EACjCC,MAAc,KAEpB,QAASC,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAE5B,MAAMC,EAAa,KAAK,OAAA,EAAW,GAAM,KAAON,EAAU,KAAK,MAAM,KAAK,OAAA,EAAWA,EAAU,MAAM,CAAC,EAAE,GAGlGO,EAAYN,EAAW,KAAK,MAAM,KAAK,OAAA,EAAWA,EAAW,MAAM,CAAC,EAGpEO,EAAS,KAAK,OAAA,EAAW,KAAO,GAGhCC,EAAcD,EAASD,EAAU,eAGjCG,EAAQ,KAAK,SAAW,GAAM,KAAO,aAAaL,EAAI,CAAC,GAGvDM,EAAa,IAAI,KAAKR,EAAU,UAAY,KAAK,OAAA,GAAYC,EAAQ,QAAA,EAAYD,EAAU,UAAU,EAE3GD,EAAW,IACTH,EACAO,EACAC,EAAU,GACVC,EACAD,EAAU,eACVE,EACAC,EACAC,EAAW,YAAA,CAAY,CAE3B,CAEA,QAAQ,IAAI,uCAAuC,CACrD,CAGI,QAAQ,OAAS,QACnBhB,EAAA,EAAmB,KAAK,IAAM,CAC5B,QAAQ,IAAI,gCAAgC,EAC5C,QAAQ,KAAK,CAAC,CAChB,CAAC,EAAE,MAAMiB,GAAS,CAChB,QAAQ,MAAM,8BAA+BA,CAAK,EAClD,QAAQ,KAAK,CAAC,CAChB,CAAC"}